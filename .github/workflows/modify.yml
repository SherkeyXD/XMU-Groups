
name: Modify group messages

on:
  workflow_dispatch:
    inputs:
      id:
        description: '群号'
        required: true
      name:
        description: '群名称'
        required: true
      tags:
        description: '群标签'
        required: true
      url:
        description: '加群链接'
        required: true

permissions:
  contents: write
  pull-requests: write

jobs:
  Modify:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v3

      - name: Modify groups.json
        run: |
          python3 main.py modify -id "${{ github.event.inputs.id }}" -name "${{ github.event.inputs.name }}" -tags "${{ github.event.inputs.tags }}" -url "${{ github.event.inputs.url }}"

      - name: Commit changes
        uses: EndBug/add-and-commit@v9
        with: 
          add: "groups.json"
          message: "group: 修改了群${{ github.event.inputs.id }}的内容"
          push: true

      - name: Create Pull Request
        run : |
          gh pr create \
          --repo SherkeyXD/XMU-Groups \
          --title "[群信息修改]${{ github.event.inputs.name }}(${{ github.event.inputs.id }})" \
          --body-file "pr-body.md" \
          --label automated \
          --assignee SherkeyXD \
        env:
          GITHUB_TOKEN: ${{ secrets.PAT }}