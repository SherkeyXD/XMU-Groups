
name: Modify group messages

on:
  workflow_dispatch:
    inputs:
      id:
        description: '群号'
        required: true
      name:
        description: '群名称'
        required: true
      tags:
        description: '群标签'
        required: true
      url:
        description: '加群链接'
        required: true

permissions:
  contents: write
  pull-requests: write

jobs:
  Modify:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v3

      - name: Modify group.json
        run: |
          python3 main.py modify -id "${{ github.event.inputs.id }}" -name "${{ github.event.inputs.name }}" -tags "${{ github.event.inputs.tags }}" -url "${{ github.event.inputs.url }}"

      - name: Commit changes
        run: |
          git config --local user.email "${{ github.actor }}@users.noreply.github.com"
          git config --local user.name "${{ github.actor }}"
          git add .
          git commit -m "group: 修改了群${{ github.event.inputs.id }}的内容"

      - name: Create Pull Request
        run : |
          gh pr create \
          --repo SherkeyXD/XMU-Groups \
          --base main \
          --head "${{ github.ref }}" \
          --title "[群信息修改]${{ github.event.inputs.name }}(${{ github.event.inputs.id }})" \
          --body "群名称：${{ github.event.inputs.name }}\n群号：${{ github.event.inputs.id }}\n群标签：${{ github.event.inputs.tags }}\n加群链接：${{ github.event.inputs.url }}" \
          --label automated \
          --assignee SherkeyXD \
        with:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}